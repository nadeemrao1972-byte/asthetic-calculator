!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e8679ace-0d15-4e3f-a5af-c22a49451944",e._sentryDebugIdIdentifier="sentry-dbid-e8679ace-0d15-4e3f-a5af-c22a49451944")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"ef5ff8f4"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4283],{317:(e,t,n)=>{n.d(t,{u9:()=>d,Pz:()=>f});var r=n(29935),a=n(82643),i=n(53847),o=function(e){var t=e.dbName,n=e.version,o=e.onUpgrade;return(0,r._)(function(){return(0,a.YH)(this,function(e){return[2,new Promise(function(e,r){var a=indexedDB.open(t,n);a.onerror=function(){var e;return r(Error("Failed to open database: ".concat(null==(e=a.error)?void 0:e.message)))},a.onsuccess=function(){return e(a.result)},o&&(a.onupgradeneeded=function(e){var t=e.target;(0,i._)(t,IDBOpenDBRequest)&&t.result?o(t.result):r(Error("Invalid target during upgrade."))})})]})})()},s=function(e){var t=e.db,n=e.storeName,i=e.mode,o=e.operation;return(0,r._)(function(){return(0,a.YH)(this,function(e){return[2,new Promise(function(e,r){if(!t.objectStoreNames.contains(n))return r(Error('Object store "'.concat(n,'" does not exist in the database.')));var a=t.transaction([n],i),s=o(a.objectStore(n));s.onsuccess=function(){return e(s.result)},s.onerror=function(){var e;return r(Error("Transaction error: ".concat(null==(e=s.error)?void 0:e.message)))},a.onabort=function(){return r(Error("Transaction was aborted."))},a.onerror=function(){return r(Error("Transaction encountered an error."))}})]})})()},u="LandingPageAgentAttachments",c=null,l=function(){return(0,r._)(function(){return(0,a.YH)(this,function(e){return c?[2,c]:[2,c=o({dbName:"ReplitAgentAttachments",version:1,onUpgrade:function(e){e.objectStoreNames.contains(u)||e.createObjectStore(u,{keyPath:"id",autoIncrement:!0})}})]})})()},f=function(){return(0,r._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return[4,l()];case 1:var t;return[2,s({db:(t={db:e.sent(),storeName:u}).db,storeName:t.storeName,mode:"readonly",operation:function(e){return e.getAll()}})]}})})()},d=function(){return(0,r._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(0,r._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return[4,l()];case 1:var t;return[2,s({db:(t={db:e.sent(),storeName:u}).db,storeName:t.storeName,mode:"readwrite",operation:function(e){return e.clear()}})]}})})()];case 1:return e.sent(),[3,3];case 2:return e.sent(),[2];case 3:return[2]}})})()}},15664:(e,t,n)=>{n.d(t,{T:()=>g});var r=n(29935),a=n(17844),i=n(82643),o=n(89961),s=n(74248),u=n(86035),c=n(97598),l=n(80719),f=n(30284),d=n(86103),p=n(47737),m=n(34778),h=n(13927);function g(e){var t=e.currentUserUsername,n=e.currentUserEmail,g=e.currentUserTimeCreated,v=e.updatePromptConnectionStatus,_=(0,d._P)({controlName:"flag-repl-creation-slack-bot-events"}),y=(0,p.m6)();return function(e){return(0,r._)(function(e){var d,p,E,I,b,A,T,S,w,R,P,C,k,N,F,L,U,O,x;return(0,i.YH)(this,function(M){switch(M.label){case 0:return d=e.prompt,p=e.uploadedFiles,E=e.requestedStackBlueprint,I=e.agentStackTriggerType,b=e.replId,A=e.currentUserId,T=e.orgId,S=e.customStackReplId,w=e.themeConfig,R=e.initialBuildMode,P=e.agentChatMode,C=e.agentStackPlatformType,k=(0,o.hV)({currentUserId:A}),(N=new o.Zn({clientId:k,serverId:l.wV,connectImmediately:!0,getEndpoint:function(){return(0,r._)(function(){var e,t;return(0,i.YH)(this,function(n){switch(n.label){case 0:return[4,(0,l.j2)(b,k,T)];case 1:return e=n.sent(),(t=new URL((0,l.qK)())).searchParams.set("auth_token",e),[2,t]}})})()},onProtocolError:function(e){throw Error("Failed to send agent prompt. Protocol error: ".concat(e.message))},onRetriesExceeded:function(){throw Error("Unable to connect. Please try again later.")}})).status.subscribe(function(e){v(e)}),F=(0,s.uc)({sessionType:u.dF3.AGENT_SESSION,replId:b}),[4,N.service.createSession.rpc(F)];case 1:if(!(L=M.sent()).ok)throw Error("Failed to send agent prompt. Session creation failed.");return U=L.payload.sessionId,O=L.payload.sessionCreationEventId,x=(0,c.k)({session:U,parent:O,model:u.e3q.ADVANCED,sender:{id:A,membership:u.VMq.CORE,timeCreated:new Date(g)},addToChild:!1,data:{kind:"message",message:d,uploadedFiles:p,requestedStackBlueprint:E,agentStackTriggerType:I,intent:u.qRv.AGENT,customStackReplId:S,themeConfig:w,agentConfig:{webSearchEnabled:!0,enableAutomatedTesting:!1,imageGenerationEnabled:!0,initialBuildMode:R,agentMode:P}}}),N.service.createEvent.rpc(x.request),(0,m.u4)(f.AZ.START_WITH_AI_USED,(0,a._)({action:"created_agent_session",prompt:d,attachments:p,repl_id:b,username:t,email:n,is_mobile:y,has_agent:!0,send_to_slack_bot:_,session_id:U,langsmith_url:(0,l.Yd)(U,u.dF3.AGENT_SESSION)},C&&{agentStackPlatformType:C})),(0,h.pI)({action:"created_new_session",sessionId:U}),[2]}})}).apply(this,arguments)}}},33868:(e,t,n)=>{n.d(t,{Qq:()=>l,Zn:()=>f,lj:()=>u,wr:()=>c});var r=n(29935),a=n(86105),i=n(82643),o=n(41409),s=n(49555),u=function(e){return e.AlreadyExists="ALREADY_EXIST",e.FileRead="FILE_READ",e.Network="NETWORK",e}({}),c=0xc800000,l=1e6;function f(e){return(0,r._)(function(e){var t,n,u,f,d,p,m,h,g,v,_,y;return(0,i.YH)(this,function(E){switch(E.label){case 0:if(t=e.parentPath,n=e.overwrite,u=e.fs,f=e.files,d=e.onStart,p=e.onUpload,m=e.onError,h=e.onDone,g=e.envMigrationFlag,f.length>l)throw Error("Trying to upload too many files at once.");if(f.reduce(function(e,t){return t.size+e},0)>c)throw Error("Total file upload size exceeds maximum limit.");return v=function(e){var t=e.targetPath,a=e.file,o=e.progress;return(0,r._)(function(){var e,r;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(n)return[3,2];return[4,u.stat(t)];case 1:if(i.sent().exists)return m(e={file:a,path:t,error:"ALREADY_EXIST"}),[2,e];i.label=2;case 2:return[4,u.transferFile(t,a,function(e,t){o.current=t/e},g)];case 3:if(i.sent().error===s.Tr.NotReadable)return m(r={file:a,path:t,error:"FILE_READ"}),[2,r];return null==p||p({file:a,path:t}),[2,{path:t,file:a}]}})})()},_=f.map(function(e){var n=e.dirPath||e.webkitRelativePath||e.name;return{targetPath:t?t+"/"+n:n,progress:(0,o.F)(0),file:e}}),null==d||d(_),[4,Promise.all(_.map(v))];case 1:return y=E.sent(),null==h||h({parentPath:t,uploads:y.filter(function(e){return!("error"in e)}),errors:y.reduce(function(e,t){return"error"in t?(0,a._)(e).concat([t]):e},[])}),[2]}})}).apply(this,arguments)}},41426:(e,t,n)=>{n.d(t,{Ls:()=>m,Vg:()=>h,_u:()=>g});var r=n(29935),a=n(17844),i=n(93629),o=n(12694),s=n(82643),u=n(21462),c=n(35992),l=n(32978),f=n(69832),d=n(33868),p=n(13927),m="attached_assets",h=function(e){return"".concat(m,"/").concat(e)};function g(e){var t=e.sessionId,n=e.uploadFiles,m=e.onError,g=(0,f.HJ)([]),v=(0,f.HJ)([]),_=(0,u.useMemo)(function(){return l.cP.combine(l.cP.from(g),l.cP.from(v)).select(function(e){var t=(0,o._)(e,2),n=t[0],r=t[1];return n.some(function(e){return e.isLoading})||r.some(function(e){return e.file.isLoading})})},[g,v]),y=(0,u.useCallback)(function(e){g.update(function(t){return(0,c.jM)(t,function(t){var n=t.findIndex(function(t){return t.path===e});-1!==n&&t.splice(n,1)})})},[g]),E=(0,u.useCallback)(function(e){v.update(function(t){return(0,c.jM)(t,function(t){var n=t.findIndex(function(t){return t.file.path===e});-1!==n&&t.splice(n,1)})})},[v]),I=(0,u.useCallback)(function(e){return(0,r._)(function(){var r,o,u,l,f,v,_,E,I;return(0,s.YH)(this,function(s){switch(s.label){case 0:r=e.map(function(e){var t=function(e){if(e){var t=e.lastIndexOf("."),n=-1!==t?e.slice(0,t):e,r=-1!==t?e.slice(t):"";return"".concat(n,"_").concat(Date.now()).concat(r)}return"pasted_".concat(Date.now())}(e.fileName);return{path:h(t),mimeType:e.file.type,file:new File([e.file],t,{type:e.file.type,lastModified:e.file.lastModified}),isLoading:!0}}),o=!0,u=!1,l=void 0;try{for(f=r[Symbol.iterator]();!(o=(v=f.next()).done);o=!0){if((_=v.value).file.size>d.wr)return null==m||m("Attachment size exceeds ".concat(d.wr/1024/1024," MB limit.")),(0,p.pI)({action:"attempted_to_attach_file_exceeding_size_limit",fileType:_.file.type,fileSize:_.file.size,sessionId:t}),[2,[]];if("image/svg+xml"===_.file.type)return null==m||m("SVG images are not allowed"),(0,p.pI)({action:"attempted_to_attach_svg_image",sessionId:t}),[2,[]]}}catch(e){u=!0,l=e}finally{try{o||null==f.return||f.return()}finally{if(u)throw l}}return E=!1,[4,new Promise(function(e){g.update(function(e){return(0,c.jM)(e,function(e){var t=r.filter(function(t){return!e.some(function(e){return e.path===t.path})});if(e.length+t.length>20)return null==m||m("You can only attach up to ".concat(20," files.")),e;E=!0,r.forEach(function(t){var n=e.findIndex(function(e){return e.path===t.path});-1!==n?e[n]=t:e.push(t)})})}),e()})];case 1:if(s.sent(),!E)return[2,[]];if(r.forEach(function(e){(0,p.pI)({action:"attached_file",fileType:e.file.type,fileSize:e.file.size,sessionId:t})}),I=r.map(function(e){return e.file}),!n)return[3,5];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,n({files:I,onError:function(e){r.forEach(function(e){return y(e.path)}),null==m||m("Error writing files: "+e)}})];case 3:return s.sent(),[3,5];case 4:return s.sent(),[2,[]];case 5:return g.update(function(e){return(0,c.jM)(e,function(e){r.forEach(function(t){var n=e.findIndex(function(e){return e.path===t.path});-1!==n&&(e[n]=(0,i._)((0,a._)({},e[n]),{isLoading:!1}))})})}),[2,r]}})})()},[n,y,m,t,g]),b=(0,u.useCallback)(function(e){var o=e.url,u=e.file;return(0,r._)(function(){var e;return(0,s.YH)(this,function(r){switch(r.label){case 0:return e=!1,[4,new Promise(function(t){v.update(function(t){return(0,c.jM)(t,function(t){var n=t.findIndex(function(e){return e.url===o&&e.file.path===u.path});if(-1===n&&t.length+g.current.length>=20)return null==m||m("You can only attach up to ".concat(20," files.")),t;e=!0,-1!==n?t[n]={url:o,file:u}:t.push({url:o,file:u})})}),t()})];case 1:if(r.sent(),!e)return[2,null];if((0,p.pI)({action:"attached_url_file",fileType:u.file.type,fileSize:u.file.size,sessionId:t}),!n)return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,n({files:[u.file],onError:function(e){E(u.path),null==m||m("Error writing URL file: "+e)}})];case 3:return r.sent(),v.update(function(e){return(0,c.jM)(e,function(e){var t=e.findIndex(function(e){return e.url===o});-1!==t&&(e[t].file=(0,i._)((0,a._)({},e[t].file),{isLoading:!1}))})}),[3,5];case 4:return r.sent(),[2,null];case 5:return[2,{url:o,file:u}]}})})()},[n,E,m,t,v,g]),A=(0,u.useCallback)(function(){g.set([]),v.set([])},[g,v]);return(0,u.useMemo)(function(){return{attachments:g,removeAttachment:y,removeUrlAttachment:E,clearAttachments:A,urlAttachments:v,addAttachments:I,addUrlAttachment:b,isLoading:_}},[g,y,E,A,v,I,b,_])}},49984:(e,t,n)=>{n.d(t,{O3:()=>m,eX:()=>g});var r=n(17844),a=n(12584),i=n(41114),o=n(39590),s=n(54744),u=n(6876),c=n(41991);function l(){var e=(0,a._)(["\n  mutation CreateAgentReplCreateRepl($input: CreateReplInput!) {\n    createRepl(input: $input, isTitleAutoGenerated: false) {\n      ... on Repl {\n        id\n        title\n        ...ReplLinkRepl\n        ...CrosisContextRepl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n  ","\n"]);return l=function(){return e},e}function f(){var e=(0,a._)(["\n  query CreateAgentReplCurrentUser {\n    currentUser {\n      id\n      username\n      ...CrosisContextCurrentUser\n      replCount {\n        ... on ReplCount {\n          count\n        }\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}var d={},p=(0,i.J1)(l(),u.r,c.c);function m(e){var t=(0,r._)({},d,e);return o.n(p,t)}var h=(0,i.J1)(f(),c.N);function g(e){var t=(0,r._)({},d,e);return s.I(h,t)}},53178:(e,t,n)=>{n.d(t,{A:()=>A});var r={};n.r(r),n.d(r,{checkAndTrack:()=>b,ensureTrackedFile:()=>y,storeOp:()=>E});var a=n(67276),i=n(34778),o=n(29935),s=n(12694),u=n(22531),c=n(82643),l=n(52535),f=n(58631),d=n(17844),p={};function m(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.info("ot client dataloss",(0,d._)({case:t,startTime:n.startTime,opsSinceFlush:n.opsSinceFlush,whileReconnecting:n.whileReconnecting,replid:n.replId,filePath:n.filePath},r))}var h={replsList:function(){return"dataLossRepls"},replFiles:function(e){return"dataLossReplFiles".concat(e)},latestOp:function(e,t){return"dataLossLatestOp--".concat(e,"--").concat(t)},latestFlushedOp:function(e,t){return"dataLossLatestFlushed--".concat(e,"--").concat(t)},latestOwnOp:function(e,t){return"dataLosslatestOwnOp--".concat(e,"--").concat(t)},opsSinceFlush:function(e,t){return"dataLossOpsSinceFlush--".concat(e,"--").concat(t)}};function g(){var e=f.A.get(h.replsList(),"array");return e||(e=[],f.A.set(h.replsList(),e)),e}function v(e){var t=f.A.get(h.replFiles(e),"array");return t||(t=[],f.A.set(h.replFiles(e),t)),t}function _(e){var t=v(e),n=!0,r=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;"string"==typeof s&&function(e,t){f.A.remove(h.latestOp(e,t)),f.A.remove(h.latestFlushedOp(e,t)),f.A.remove(h.latestOwnOp(e,t));var n=v(e).filter(function(e){return e!==t});f.A.set(h.replFiles(e),n)}(e,s)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}f.A.remove(h.replFiles(e));var u=g().filter(function(t){return t!==e});f.A.set(h.replsList(),u)}function y(e){var t,n=e.replId,r=e.filePath;(t=g()).includes(n)||(t.length>20?(_(t[0]),t[0]=n):t.push(n),f.A.set(h.replsList(),t));var a=v(n);a.includes(r)||(a.length>20?(_(a[0]),a[0]=r):a.push(r),f.A.set(h.replFiles(n),a))}function E(e){var t=e.filePath,n=e.replId,r=e.opType,a=e.op;!function(e){var t=e.filePath,n=e.replId,r=e.opType,a=e.logger,i=e.isReconnecting,o=m.bind(null,a),s="".concat(n,"--").concat(t);p[s]||(p[s]={replId:n,filePath:t,timer:null,startTime:null,whileReconnecting:0,opsSinceFlush:0});var u=p[s];if("latestFlushedOp"===r){delete p[s];var c=u.startTime;if(c){var l=Date.now()-c;l>6e4&&o("flush_delay_received",u,{elapsed:l})}var f=u.timer;f&&(clearTimeout(f),u.timer=null)}else{u.opsSinceFlush+=1,i&&(u.whileReconnecting+=1);var d,h=null!=(d=u.startTime)?d:Date.now();u.startTime=h,u.timer||(u.timer=setTimeout(function(){o("flush_delay_timeout",u)},6e4)),150===u.opsSinceFlush?o("flush_delay_small",u):1e3===u.opsSinceFlush&&o("flush_delay_large",u)}}({filePath:t,replId:n,opType:r,logger:e.logger,isReconnecting:e.isReconnecting}),f.A.set(h[r](n,t),a)}var I={};function b(e){return(0,o._)(function(e){var t,n,r,a,i,d,p,m;return(0,c.YH)(this,function(g){return t=e.filePath,n=e.replId,r=e.serverVersion,a=e.serverContent,i=e.fetchOps,d=e.logger,I[t+n]||(I[t+n]=!0,p=function(e,t){var n={latestOp:null,latestFlushedOp:null,latestOwnOp:null},r=Object.keys(n),a=!0,i=!1,o=void 0;try{for(var s,c=r[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,d=f.A.get(h[l](e,t),"object");d&&d&&(void 0===d?"undefined":(0,u._)(d))==="object"&&"number"==typeof d.crc32&&"number"==typeof d.version&&(n[l]=d)}}catch(e){i=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(i)throw o}}return n}(n,t),m=l.str(a)>>>0,Object.keys(p).forEach(function(e){return(0,o._)(function(){var t,n,a;return(0,c.YH)(this,function(o){switch(o.label){case 0:if(!(t=p[e]))return[2];if(r<t.version)return d.info("ot client dataloss",{opType:e,case:"server_forgot"}),[2];if(r===t.version)return m!==t.crc32&&d.info("ot client dataloss",{opType:e,case:"crc32_mismatch"}),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i(t.version,t.version)];case 2:return n=s._.apply(void 0,[o.sent(),1])[0],[3,4];case 3:return a=o.sent(),d.info("ot client dataloss",{opType:e,case:"error_fetching_op",originalError:String(a)}),[2];case 4:if(!n)return d.info("ot client dataloss",{opType:e,case:"op_not_found"}),[2];return n.crc32!==t.crc32&&d.info("ot client dataloss",{opType:e,case:"crc32_mismatch"}),[2]}})})()})),[2]})}).apply(this,arguments)}function A(e){var t=e.container;return(0,a.Ay)({container:t,dataloss:r,track:i.u4})}},78624:(e,t,n)=>{n.d(t,{L:()=>o});var r=n(21462),a=n(89357),i=n(39938);function o(){var e=(0,a.RL)(),t=(0,i.A)(e);return(0,r.useCallback)(function(){var e,n;return!Number.isFinite(n=parseInt(null==(e=t.current)?void 0:e.variation("flag-container-retry-minimum-ms",0),10))||n<0?0:n},[t])}},84283:(e,t,n)=>{n.d(t,{M:()=>j});var r=n(29935),a=n(53847),i=n(17844),o=n(93629),s=n(12694),u=n(82643),c=n(40185),l=n(21462),f=n(10795),d=n(49984),p=n(86035),m=n(89742),h=n(90629),g=n(12584),v=n(41114),_=n(39590);function y(){var e=(0,g._)(["\n  mutation GenerateAgentReplIcon($prompt: String!, $replId: String!) {\n    generateReplIcon(input: { prompt: $prompt, replId: $replId }) {\n      ... on GenerateReplIconResult {\n        repl {\n          id\n          iconUrl\n        }\n      }\n    }\n  }\n"]);return y=function(){return e},e}var E={},I=(0,v.J1)(y()),b=n(15664),A=n(86103),T=n(30375),S=n(35897),w=n(317),R=n(47737),P=n(55494),C=n(26279),k=n(34778),N=n(99344),F=n(71696),L=n(90352),U=n(78624),O=n(53178),x=n(33868),M=n(41426),D=n(7845),Y=n(14385);function j(e){var t,n,g,v,y,j,H,z=e.currentUser,B=(0,s._)((0,l.useState)("idle"),2),G=B[0],q=B[1],V=(0,C.pE)("folderId","string"),J=(0,R.m6)(),$=(0,S.A)().showError,X=(0,s._)((0,d.O3)(),1)[0],Z=(n=(t=(0,d.eX)()).data,g=t.error,v=t.loading,g?{loading:!1,currentUser:null,errorCode:500}:(null==n?void 0:n.currentUser)?{loading:!1,currentUser:n.currentUser,errorCode:null}:v?{loading:!0,currentUser:null,errorCode:null}:{loading:!1,currentUser:null,errorCode:403}).currentUser,K=(0,U.L)(),W=(0,c.useRouter)(),Q=(0,N.A)(),ee=(0,A._P)({controlName:"flag-killswitch-agent"}),et=(0,D.E)(),en=function(e){q("idle"),$(e.message),(0,m.B)(e),null==et||et.remove()},er=(0,s._)((0,l.useState)("disconnected"),2),ea=er[0],ei=er[1],eo=(0,b.T)({currentUserUsername:z.username,currentUserEmail:z.email,currentUserTimeCreated:z.timeCreated,updatePromptConnectionStatus:function(e){ei(e)}}),es=(H=(0,s._)((y={onError:function(e){h.Cp(e)}},j=(0,i._)({},E,y),_.n(I,j)),1)[0],function(e){var t=e.prompt,n=e.attachments,r=e.replId;H({variables:{prompt:t+(n.length>0?"\n\nWith attachments: ".concat(n.map(function(e){return e.path}).join(", ")):""),replId:r}})}),eu=function(e){switch(e){case f.J_c.Slack:return p.ezV.SLACK_MESSAGE;case f.J_c.Telegram:return p.ezV.TELEGRAM_MESSAGE;case f.J_c.TimeBased:return p.ezV.TIME_BASED;default:return}},ec="flag-electron-orbital-dance-party",el=(0,A._P)({controlName:ec}),ef=(0,T.a)();return{createAgentRepl:function(e){return(0,r._)(function(e){var t,n,s,c,l,f,d,m,h,g,v,_,y,E,I,b,A,T,S,R,C,N,U;return(0,u.YH)(this,function(D){switch(D.label){case 0:if(t=e.prompt,n=e.attachments,s=e.requestedStackBlueprint,c=e.isPrivate,l=e.teamId,f=e.orgId,d=e.customStackReplId,m=e.isExpertMode,h=e.themeConfig,g=e.initialBuildMode,v=e.appThemeId,_=e.agentStackPlatformType,ee)return $("This feature is currently unavailable."),q("idle"),[2];return(0,P.O7)(),[4,(0,w.u9)()];case 1:return D.sent(),q("creating_repl"),y=!d&&!m,E=n&&n.length>0,(I=y&&!ef&&!E)&&(el&&(null==et||et.start({text:t,attachments:n})),(0,k.u4)(k.AZ.EXPERIMENT_VARIANT_ASSIGNED,{experimentName:ec,variant:el})),b=s===p.qf8.STACK_BLUEPRINT_AGENT,[4,X({variables:{input:{aiPromptText:t,aiPromptAttachmentPaths:n.map(function(e){return e.path}),folderId:V,isPrivate:c,teamId:l,orgId:f,originId:d,detachFromProject:!!d,isInPlanningPhase:y,isExpertMode:m,isAgentStack:b,agentStackPlatformType:_}}})];case 2:if((A=D.sent()).errors)return en(Error(A.errors.map(function(e){return e.message}).join(", "))),[2];if(!A.data)return en(Error("Expected data from createRepl graphql mutation")),[2];if("message"in A.data.createRepl)return en(Error(A.data.createRepl.message)),[2];if(T=A.data.createRepl,es({prompt:t,attachments:n,replId:T.id}),el&&I&&(null==et||et.update(T)),!E)return[3,4];return S=(0,L.O)({repl:T,currentUser:Z}),(R=(0,F.Ay)({onUnrecoverableError:function(e){q("idle"),$(e.message)}})).connect({context:S,getMinimumRetryDelayMs:K}),q("configuring_repl"),[4,function(e){return(0,r._)(function(e){var t,n,r,a,i;return(0,u.YH)(this,function(o){switch(o.label){case 0:if(t=e.hasAttachments,n=e.container,r=e.attachments,a=e.handleError,!t)return[2];return i=(0,O.A)({container:n}),[4,(0,x.Zn)({parentPath:M.Ls,files:r.map(function(e){return e.file}),fs:i,onError:function(e){a(Error("Error uploading ".concat(e.path,": ").concat(e.error)))}})];case 1:return o.sent(),[2]}})}).apply(this,arguments)}({hasAttachments:E,attachments:n,container:R,handleError:en})];case 3:D.sent(),D.label=4;case 4:return D.trys.push([4,6,,7]),[4,eo({prompt:t,uploadedFiles:n.map(function(e){return{path:e.path,mimeType:e.file.type}}),requestedStackBlueprint:s,agentStackTriggerType:eu(_),replId:T.id,currentUserId:z.id,orgId:f,customStackReplId:d,themeConfig:h,initialBuildMode:g,agentChatMode:y&&!m?p.xyI.AGENT_MODE_INITIAL_PLANNING:p.xyI.AGENT_MODE_GENERAL,agentStackPlatformType:_})];case 5:return D.sent(),[3,7];case 6:return C=D.sent(),en((0,a._)(C,Error)?C:Error(String(C))),[2];case 7:if(q("opening_repl"),N={enterInAgentMode:!0,enterInExpertMode:m,appThemeId:v},U=(0,Y.q1)(T,N),!J)return[3,8];return window.location.href=(0,Y.cY)(T,N),[3,10];case 8:return[4,W.push((0,o._)((0,i._)({},U.href),{pathname:Q}),U.as)];case 9:D.sent(),D.label=10;case 10:return q("idle"),[2]}})}).apply(this,arguments)},status:G,agentPromptRiverConnectionStatus:ea}}},89742:(e,t,n)=>{n.d(t,{B:()=>a});var r=n(90629);function a(e,t){return r.v4(function(n){n.setTag("start-with-ai",!0),t&&n.setExtras(t),r.Cp(e)}),e}},90352:(e,t,n)=>{n.d(t,{$:()=>u,O:()=>s});var r=n(17844),a=n(21462),i=n(23099),o=n.n(i);function s(e){var t=e.repl,n=e.currentUser;return{asViewer:e.asViewer,repl:{__typename:"Repl",authorizations:t.authorizations,id:t.id,language:t.language},currentUser:n?{__typename:"CurrentUser",id:n.id,username:n.username,isSubscribed:n.isSubscribed}:void 0}}function u(e){var t=e?s((0,r._)({},e)):null,n=(0,a.useRef)(t);return o()(t,n.current)||(n.current=t),n.current}}}]);
//# sourceMappingURL=4283-5655378b6e94596e.js.map